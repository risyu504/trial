# コーディングルール(内部共通規約)

このファイルは、開発者がソースコードを記述する際に要請される、コードの書き方や形式に関する決まりごとを記したものです。

このフォルダに関しての説明は、[`README.md`](./README.md) に記述しています。

- [コーディングルール(内部共通規約)](#コーディングルール内部共通規約)
  - [かんたんな説明](#かんたんな説明)
  - [コーディングルールとは](#コーディングルールとは)
  - [基本方針](#基本方針)
  - [基本概念](#基本概念)
  - [機能利用の設計規則](#機能利用の設計規則)
  - [記述規則](#記述規則)
  - [命名規則](#命名規則)
  - [コメント記法](#コメント記法)
  - [構造設計](#構造設計)
  - [補足](#補足)
  - [作成者](#作成者)

## かんたんな説明

この文書は、「ソースコードをどう書くか」の決まりごとをまとめたものです。

たとえば、

- どんな名前をつければ、あとで見てわかりやすいか
- どこまで細かくコメントを書けばいいか
- どこまで自由に書いてよくて、どこから先はルールで決めるか

そんな「書き方のルール」や「考え方のよりどころ」が書いてあります。

あとで自分が見返したときにもわかるように、理由や意味も書いてあります。すぐに全部わからなくても、ゆっくり読めば大丈夫です。

## コーディングルールとは

コーディングルールとは、ソースコードの書き方を統一するためのルールです。

チームやプロジェクトで、誰が書いても同じような書き方になるように決められます。見た目をそろえるだけでなく、書き方や使い方の考え方にも関係します。

この文書では、単なる「目安」ではなく、実際に守るべき「規約」として定めています。

## 基本方針

この規則は、[「基本原則」](../10_Principles/basicprinciples.md)に基づいて設計されています。  
単なる決まりごとではなく、それがなぜ必要か、何を大事にしているかを明記し、将来の自分が判断や変更を行うための手がかりとなるようにしています。  
尚、規則は「明文化して守るもの」であり、暗黙の柔軟性は許容しません。  
→ 必要に応じて変更できるものであり、変更するものです。また、解釈による改変は禁止です。

この文書で定める各ルールは、プロジェクトの一貫性と保守性を高めるためのものです。内容は実際の作業や判断の中で見直され、必要に応じて更新されます。  
また、本来であれば規則とその意図・背景は分離すべきものですが、ここでは「学ぶため」「自分の理解を深めるため」という目的を含むため、意図や経緯も併せて記述しています。

以下は、この規則を設けるにあたっての考え方です。

- **分かりやすさを最優先に**  
人間にとっての読みやすさ・理解のしやすさだけでなく、検索・置換のしやすさ、エラー原因の発見のしやすさ、修正や変更の影響範囲の把握のしやすさなど、開発作業全体での「分かりやすさ」を重視します。  
書きやすさや処理速度よりも、まず分かりやすさを優先します。ただし、読み直しやすさ・変更のしやすさという点での「書き直しやすさ」や、極端な非効率を避けるための「ある程度の処理速度」も考慮します。
- **説明の存在を重視**  
ソースコードだけでなく、コメントや別文書での補足も含めて「わかる」状態を作ります。コード内コメントの書き方についても統一し、変更に応じて説明が更新されるようにします。
- **規則は読みやすくあるべき**  
規則が分かりにくくて開発の妨げになるようでは本末転倒です。必要に応じて構成や表現を見直し、読み返しやすく保守しやすい状態を維持します。
- **汎用性と統一性を重視**  
言語や技術に依存しすぎず、機能間での共通性や流用性を保ちやすい構成を目指します。
- **規則の更新は柔軟に**  
規則には版数管理は行いませんが、日々の開発の中で改善・追加・見直しを行います。
- **他者の権利に配慮する**  
他者が作成したコードや資料を扱う際には、権利関係を明確にし、必要な配慮を行います。  
また、自身の著作権を放棄しないことも、結果的に他者の権利を不当に侵害しないための手段としています。  
他者の成果物や権利物に対する明確な区分と配慮は、設計・構造の段階で意識するべき要素と捉えています。ファイル配置、依存関係の整理、参照範囲の明確化などによって、自作と他作を技術的にも視覚的にも切り分けることを基本方針とします。

1. この規則は、[「基本原則」](../10_Principles/basicprinciples.md)に基づいて設計されています。  
  各ルールには、その背景となる意図も記載し、基本原則に即して判断・変更できるようにします。
2. 他者の権利の把握, 切り分けは、明確に行う努力をします。
3. 著作権などの権利は放棄しません。これは他者の権利をより侵害しない為の手段です。
4. 主な構成は、**基本概念**, **利用規則**, **記述規則**, **命名規則** などになります。
5. 学ぶという点が含まれている事から、本来あるべき規約の書き方とは異なります。もし組織で規約を用意する場合は、当然ながら規則自体とその経緯は別々にするべきでしょう。

## 基本概念

1. 開発者が一人なので集団での意識統一の面の実績はないのですが、**過去の自分と今の自分の意識統一**という考え方で規約を用意しています。一年後の自分が改めて見ても、読める(分かる)ソースコードを書く為の指針という事です。
2. 分かるという点で、それはこの規約自体でも同じ考えで記述しています。故に決まり事だけでなく、目的や原因など何故の部分も記述します。
3. ソースコードだけで分かる必要はなく、コードファイル内のコメントでも別ファイルでも何でも良いから、**説明を記述する**事で分かる様にします。尚、ソースコードを変えれば説明も変える必要がある為、コメントの記述の仕方も統一します。
4. 個人の決めごとなので、版数管理はしないけど規約自体の**日々の更新はあり**としています。(ソースコードの版数管理はする前提で、規約は用意する)
5. 分かり易さとは、人の読み易さ, 理解のし易さだけでなく、ツールを用いての検索のし易さ, 文字列一括変換のし易さも含めています。
6. **開発のし易さ**, 既存資源としての**再利用のし易さ**だけでなく、エラー発生時の問題の箇所の**見つけ易さ**や、変更をする時の影響箇所の**把握のし易さ**等も目的としています。
7. **書き易さ**よりも分かり易さを優先しますが、書き直しのし易さも分かり易さの一部だと考えています。
8. **処理速度**よりも分かり易さを優先しますが、処理速度も多少は意識しています。
9. 各言語の特性を意識しつつも、汎用的, 統一性のある規約とします。これは関連のある機能間でのソースコード(資源)の使い廻しや変更の容易さを重視しての事です。
10. いちいち規約を調べ直さないと開発自体が出来ないという本末転倒を避ける為に、規約自体も分かり易くする事を心掛けます。

## 機能利用の設計規則

1. この節では、開発資源の使い方に関する取り決めを定める。  
これは、他者に対する規則ではなく、ある開発資源（例：ファイル、機能、モジュール）を他の資源から利用する際の方針を示すものである。
2. 利用関係（依存関係）を明確にする。  
使う側が、何を前提として動作するのかを明らかにしておくことで、処理の理解や修正時の影響範囲の把握が容易になる。
3. 機能の利用は一方向の流れになるように心がける。  
個々の機能だけでなく、機能のまとまり（フォルダ単位など）としても一方向の利用関係を保つ。  
この原則を守るために、同じ機能を複数の場所に配置してもよい。その際は、その理由をコメントなどで明示し、内容の統一性を保つよう努める。
4. フォルダの外にある機能を利用する際は、「利用してよい」と明示されている機能に限る。  
そのため、共通的に使われる機能は専用の場所（例：全体で共有されるファイルをまとめたフォルダ）にまとめておく。
5. 他のフォルダに機能を提供する場合は、提供用のファイルを各フォルダに設け、そこに明示的にまとめる。  
これにより、どの機能が外部に公開されているかが明確になる。
6. 同一フォルダ内でも、ファイル間での相互依存は避ける。  
複数のファイルから使われる処理は、専用のファイルに分けて記述し、個別のファイル同士が直接依存しないようにする。
同じ処理を複数のファイルに分けて書くことになっても構わないが、その場合は変更しやすいように、内容の一貫性に配慮する。
7. 機能ごとにファイルを分ける。  
どの処理がどのファイルにあるかを明確にすることで、修正や変更の影響範囲を把握しやすくし、管理を簡単にする。
8. ファイル内で他の機能を利用する際は、読みやすさを考慮して、できるだけ参照先の記述が後ろにこないようにする。  
これは逐次処理の順序ではなく、読み手が処理をたどりやすくするための工夫であり、読みやすさの観点から前後が入れ替わっても問題ない。
9. 開発によって生成されたファイルは、必ず開発環境で個別に確認し、必要なものをコピーして運用環境に移動する。  
自動でまとめて転送するのではなく、内容を確認してから移すことを原則とする。

## 記述規則

1. ソースコード, コメント, 説明書などの記述の仕方を、記述規則として定めます。
2. 記述順に意味を持たせて、読みやすくする。
3. インデントはタブでなく空白で２文字とする。(エディタのタブを２文字と設定して、保存する時に空白に置き換える設定にすれば良い)
4. 短文については、一行にまとめても良い。
5. 無理に処理を１つの文にまとめない。まとめられる場合でも、検証の容易さを意識して複数の処理に分ける事も大事です。((2+1)x5=15 と１つの式にしないで、2+1=3, 3x5=15 と２つの式に分ける。処理速度よりも、分かり易さを優先します。無理に分ける必要はなく、式の意味が分かり易い事を重要とします。)
6. 同じ機能だからとして、安易に内部処理として外出ししない。簡単な処理は個々に記述して処理速度も考慮する。(処理の集約よりも、処理速度を優先します。検証や変更を意識して、意味のある集約とする。)
7. 類似の機能だからとして、安易に１つの処理としてまとめない。まとめた後に、その処理内で**条件の判断が増える**ので記述も増えて処理も遅くなります。出来るのであれば、類似の物から同一の箇所を切り出して１つの処理にすれば良い。(処理の集約は、処理の関係を管理しないと修正などの変更の影響範囲が分かりにくくなります。変更箇所が分かり易いようで、変更の影響範囲の関係で反って変更しにくくなります。)
8. 他の行との文字位置を揃える記述は、場所を選ぶ事とする。これは複数ファイルの記述の一括変換(検索)を意識しての事で、文字位置を揃える為に空白の数が異なり一括変換(検索)が困難になります。一括処理と個別の読みやすさとの天秤になります。
9. 各フォルダに説明書き(`README.md`)を用意して、そのフォルダ内の規約も明記する。(共通の部分は、個々に記述する必要はありません。)
10. CSS設計の**FLOCSS**を考慮する。HTML作成(Pug)の時点でも考慮する。
11. CSSでは、要素セレクタだけでも可能か否かも考慮する。これはCSS側のセレクタの検討であり、HTMLの構造では考慮する必要はありません。ただ、HTMLの class属性に関わる事なので、その編集機能は用意する必要はあります。
12. CSSの開発には、Sassを用いる。HTMLの開発には、Pugを用いる。SassやPugを用いる理由は、セレクタの編集(管理)を用意にする為です。
13. SassにはSASSとSCSSの２つの構文がありますが、ここではSCSS構文を採用します。(単に統一した方が コピペ, 文字列検索, コードの一括更新などがし易いのと、慣れの問題です。)
14. SassのCSS用コメント`/* xxx */`は、CSSを生成する側で記述する事とする。
15. SassのSCSS用コメント`// xxx`は、SassDoc を意識して付与する。
16. コメントの文章の書き方は、体言止めで文字数の軽減を図る事を推奨する。丁寧な説明は、別ファイルの説明書にて行う。
17. Sassの!defaultフラグの使用は、個々のファイル内用の制御変数を除き原則禁止とする。  
(変える必要があるなら記述自体を書き換えるか別途に用意する。)

## 命名規則

命名規則は、改めて「[命名規則](./Naming/README.md)」に記します。

## コメント記法

コメント記法は、改めて「[コメント記法](./Writingstyle/commentsyntax.md)」に記します。

## 構造設計

構造設計は、改めて「[構造設計](./Structure/README.md)」に記します。

## 補足

- [Sass](https://sass-lang.com/)は、CSSのメタ言語です。
- SCSSは、Sassの構文の一つです。
- [FLOCSS](https://github.com/hiloki/flocss)は、CSS設計の一つです。
- [Pug](https://pugjs.org/api/getting-started.html)は、HTMLを出力するテンプレートエンジンです。
- [テンプレートエンジン](https://ja.wikipedia.org/wiki/%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3)は、テンプレートと呼ばれる雛形と、あるデータモデルで表現される入力データを合成し、成果ドキュメントを出力するソフトウェアまたはソフトウェアコンポーネントである。

## 作成者

Copyright(C) 2022-2025 KOUTAN
