# コーディングルール(内部共通規約)

このファイルは、開発者がソースコードを記述する際に要請される、コードの書き方や形式に関する決まりごとを記したものです。

このフォルダに関しての説明は、[`README.md`](./README.md) に記述しています。

## 目次

- [コーディングルール(内部共通規約)](#コーディングルール内部共通規約)
  - [目次](#目次)
  - [概要](#概要)
  - [基本概念](#基本概念)
  - [利用規則](#利用規則)
  - [記述規則](#記述規則)
  - [命名規則](#命名規則)
  - [補足](#補足)
  - [作成者](#作成者)

## 概要

1. 内部(開発者個人)の共通の規約(考え方と統一している事)の**メモ書き**です。
2. 明文化して清書する事によって、自分の理解度の**確認**も兼ねています。
3. **何故**そう決めるのかの部分も記述する事によって、自分の理解度を上げるようにしています。
4. 他者の権利の把握, 切り分けは、明確に行う努力をします。
5. 著作権などの権利は放棄しません。これは他者の権利をより侵害しない為の手段です。
6. 主な構成は、**基本概念**, **利用規則**, **記述規則**, **命名規則** などになります。
7. 学ぶという点が含まれている事から、本来あるべき規約の書き方とは異なります。もし組織で規約を用意する場合は、当然ながら規則自体とその経緯は別々にするべきでしょう。

## 基本概念

1. 開発者が一人なので集団での意識統一の面の実績はないのですが、**過去の自分と今の自分の意識統一**という考え方で規約を用意しています。一年後の自分が改めて見ても、読める(分かる)ソースコードを書く為の指針という事です。
2. 分かるという点で、それはこの規約自体でも同じ考えで記述しています。故に決まり事だけでなく、目的や原因など何故の部分も記述します。
3. ソースコードだけで分かる必要はなく、コードファイル内のコメントでも別ファイルでも何でも良いから、**説明を記述する**事で分かる様にします。尚、ソースコードを変えれば説明も変える必要がある為、コメントの記述の仕方も統一します。
4. 個人の決めごとなので、版数管理はしないけど規約自体の**日々の更新はあり**としています。(ソースコードの版数管理はする前提で、規約は用意する)
5. 分かり易さとは、人の読み易さ, 理解のし易さだけでなく、ツールを用いての検索のし易さ, 文字列一括変換のし易さも含めています。
6. **開発のし易さ**, 既存資源としての**再利用のし易さ**だけでなく、エラー発生時の問題の箇所の**見つけ易さ**や、変更をする時の影響箇所の**把握のし易さ**等も目的としています。
7. **書き易さ**よりも分かり易さを優先しますが、書き直しのし易さも分かり易さの一部だと考えています。
8. **処理速度**よりも分かり易さを優先しますが、処理速度も多少は意識しています。
9. 各言語の特性を意識しつつも、汎用的, 統一性のある規約とします。これは関連のある機能間でのソースコード(資源)の使い廻しや変更の容易さを重視しての事です。
10. いちいち規約を調べ直さないと開発自体が出来ないという本末転倒を避ける為に、規約自体も分かり易くする事を心掛けます。

## 利用規則

1. 開発資源の使い方を、利用規則として定めます。
2. **依存関係**を明確にする。それにより、使う時の必要資源の把握や、処理を読む時の関係の把握を容易にして、運用や改修を容易にする。
3. 機能の利用は**一方通行**となるようにする。これは個々の機能としてだけではなく、機能の纏まりとして見ても一方通行となるようにする。それを実現する為に同一の機能を複数の箇所に用意しても良い。ただしその場合は、その旨をコメント等で分かる様にする事と修正, 変更の容易さを意識して記述を同一となる様に努力する。
4. 当該フォルダ外の機能の利用は、その機能が公開されている物だけとする。その為に、**共通メンバフォルダ**(Globalフォルダ)を用意する。
5. フォルダ外に機能を公開する為に、各フォルダに**インデックスファイル**(_index)を用意する。
6. フォルダ内でも相互依存を避ける為に、**内部用処理ファイル**(_common)を用意する。同一の機能が複数のファイルに記述される事になるが、相互依存を避ける事と用途の分離管理を両立させる事を優先する。多くの機能を１つのファイルにまとめるとファイル間の依存関係は簡素ににりますが、ファイル内の管理が難しくなります。
7. 機能ごとにファイルを分ける。これによって、使う機能で使うファイルを限定できる様になります。使うファイルを限定できるという事は、修正, 変更などの影響範囲が把握し易いという事です。
8. ファイル内の機能を利用する場合は、記述順に配慮して出来るだけ利用先が後の記述にならないようにする。これは機能の辿り易さ(読み易さ)を意識した物であり、逐次処理を意識した物ではないので、読み易さによっては記述順が前後する事は良しとします。
9. 開発での生成物は、かならず開発環境で確認して個別にコピーで運用環境に移動させる。

## 記述規則

1. ソースコード, コメント, 説明書などの記述の仕方を、記述規則として定めます。
2. 記述順に意味を持たせて、読みやすくする。
3. インデントはタブでなく空白で２文字とする。(エディタのタブを２文字と設定して、保存する時に空白に置き換える設定にすれば良い)
4. 短文については、一行にまとめても良い。
5. 無理に処理を１つの文にまとめない。まとめられる場合でも、検証の容易さを意識して複数の処理に分ける事も大事です。((2+1)x5=15 と１つの式にしないで、2+1=3, 3x5=15 と２つの式に分ける。処理速度よりも、分かり易さを優先します。無理に分ける必要はなく、式の意味が分かり易い事を重要とします。)
6. 同じ機能だからとして、安易に内部処理として外出ししない。簡単な処理は個々に記述して処理速度も考慮する。(処理の集約よりも、処理速度を優先します。検証や変更を意識して、意味のある集約とする。)
7. 類似の機能だからとして、安易に１つの処理としてまとめない。まとめた後に、その処理内で**条件の判断が増える**ので記述も増えて処理も遅くなります。出来るのであれば、類似の物から同一の箇所を切り出して１つの処理にすれば良い。(処理の集約は、処理の関係を管理しないと修正などの変更の影響範囲が分かりにくくなります。変更箇所が分かり易いようで、変更の影響範囲の関係で反って変更しにくくなります。)
8. 他の行との文字位置を揃える記述は、場所を選ぶ事とする。これは複数ファイルの記述の一括変換(検索)を意識しての事で、文字位置を揃える為に空白の数が異なり一括変換(検索)が困難になります。一括処理と個別の読みやすさとの天秤になります。
9. 各フォルダに説明書き(`README.md`)を用意して、そのフォルダ内の規約も明記する。(共通の部分は、個々に記述する必要はありません。)
10. CSS設計の**FLOCSS**を考慮する。HTML作成(Pug)の時点でも考慮する。
11. CSSでは、要素セレクタだけでも可能か否かも考慮する。これはCSS側のセレクタの検討であり、HTMLの構造では考慮する必要はありません。ただ、HTMLの class属性に関わる事なので、その編集機能は用意する必要はあります。
12. CSSの開発には、Sassを用いる。HTMLの開発には、Pugを用いる。SassやPugを用いる理由は、セレクタの編集(管理)を用意にする為です。
13. SassにはSASSとSCSSの２つの構文がありますが、ここではSCSS構文を採用します。(単に統一した方が コピペ, 文字列検索, コードの一括更新などがし易いのと、慣れの問題です。)
14. SassのCSS用コメント`/* xxx */`は、CSSを生成する側で記述する事とする。
15. SassのSCSS用コメント`// xxx`は、SassDoc を意識して付与する。
16. コメントの文章の書き方は、体言止めで文字数の軽減を図る事を推奨する。丁寧な説明は、別ファイルの説明書にて行う。
17. Sassの!defaultフラグの使用は、個々のファイル内用の制御変数を除き原則禁止とする。  
(変える必要があるなら記述自体を書き換えるか別途に用意する。)

## 命名規則

命名規則は、改めて「[命名規則](./namingconvention.md)」に記します。

## 補足

- [Sass](https://sass-lang.com/)は、CSSのメタ言語です。
- SCSSは、Sassの構文の一つです。
- [FLOCSS](https://github.com/hiloki/flocss)は、CSS設計の一つです。
- [Pug](https://pugjs.org/api/getting-started.html)は、HTMLを出力するテンプレートエンジンです。
- [テンプレートエンジン](https://ja.wikipedia.org/wiki/%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3)は、テンプレートと呼ばれる雛形と、あるデータモデルで表現される入力データを合成し、成果ドキュメントを出力するソフトウェアまたはソフトウェアコンポーネントである。

## 作成者

Copyright(C) 2022-2025 KOUTAN
